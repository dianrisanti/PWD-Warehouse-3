{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\knigh\\\\Documents\\\\PURWADHIKA JCWM\\\\final_project\\\\PWD-Warehouse-3\\\\Final_Project_Group_3\\\\Front_End\\\\pwd_warehouse_03\\\\src\\\\pages\\\\history.js\",\n    _s = $RefreshSig$();\n\nimport React from 'react';\nimport Axios from 'axios';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { Accordion, Card, Table, Image, Button } from 'react-bootstrap';\nimport { CancelOrder, ConfirmArrived, paymentConf } from '../actions';\nimport { Link } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst HistoryPage = () => {\n  _s();\n\n  const [data, setData] = React.useState([]);\n  const [refresh, setRefresh] = React.useState(0);\n  const {\n    id\n  } = useSelector(state => {\n    return {\n      id: state.user.id_user\n    };\n  });\n  const dispatch = useDispatch();\n  React.useEffect(() => {\n    async function fetchData() {\n      try {\n        const res = await Axios.get(`http://localhost:2000/cart/history/${parseInt(id)}`);\n        setData(res.data);\n      } catch (err) {\n        console.log(err);\n      }\n    }\n\n    fetchData();\n  }, [id, refresh]);\n\n  function handlePaymentCon(e) {\n    console.log(e);\n    dispatch(paymentConf(e));\n  }\n\n  const cancelOrder = e => {\n    console.log(e);\n    dispatch(CancelOrder(e));\n    let CancelMsg = {\n      message: \"Canceled by USER\"\n    };\n    Axios.post(`http://localhost:2000/admin/cancelOrder/${e}`, CancelMsg).then(res => {\n      console.log(res.data);\n      let useRefresh = refresh;\n      setRefresh(refresh + 1);\n      console.log(\"refresh request executed =\", useRefresh, \"times\");\n    }).catch(err => {\n      console.log(err);\n    });\n  };\n\n  const confirmArrived = e => {\n    setRefresh(refresh + 5);\n    dispatch(ConfirmArrived(e));\n    let useRefresh = refresh;\n    console.log(\"refresh request executed =\", useRefresh, \"times\");\n    console.log(e);\n  };\n\n  const renderFooter = (status, order_number, paymentConf, msg) => {\n    if (status === \"Not Paid\") {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          justifyContent: 'space-between',\n          width: 235,\n          marginLeft: 970,\n          marginBottom: 15\n        },\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          variant: \"danger\",\n          onClick: () => cancelOrder(order_number),\n          children: \"Cancel\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 74,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          as: Link,\n          to: \"/upload_payment\",\n          style: {\n            marginRight: '5px'\n          },\n          onClick: () => handlePaymentCon(order_number),\n          children: \" Confirm Payment \"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 75,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 17\n      }, this);\n    }\n\n    if (status === \"Paid\") {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          children: /*#__PURE__*/_jsxDEV(\"i\", {\n            style: {\n              color: \"#457b9d\"\n            },\n            children: \"Waiting for approval payment confirmation\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 83,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 17\n      }, this);\n    }\n\n    if (status === \"On Delivery\") {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          justifyContent: 'flex-end',\n          marginRight: 25,\n          marginBottom: 15\n        },\n        children: /*#__PURE__*/_jsxDEV(Button, {\n          variant: \"success\",\n          style: {\n            width: '100px',\n            fontSize: 18\n          },\n          onClick: () => confirmArrived(order_number),\n          children: \"Done\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 17\n      }, this);\n    }\n\n    if (status === \"Canceled\" && paymentConf === 1) {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          children: /*#__PURE__*/_jsxDEV(\"i\", {\n            style: {\n              color: \"#457b9d\"\n            },\n            children: \"Your payment has been refunded\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 99,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 17\n      }, this);\n    }\n\n    if (status === \"Canceled\") {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          children: /*#__PURE__*/_jsxDEV(\"i\", {\n            style: {\n              color: \"#457b9d\"\n            },\n            children: msg\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 108,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 17\n      }, this);\n    }\n  };\n\n  const renderTbody = () => {\n    return /*#__PURE__*/_jsxDEV(Accordion, {\n      children: data.map((item, index) => {\n        return /*#__PURE__*/_jsxDEV(Card, {\n          children: [/*#__PURE__*/_jsxDEV(Card.Header, {\n            children: /*#__PURE__*/_jsxDEV(Accordion.Toggle, {\n              as: Card.Header,\n              variant: \"link\",\n              eventKey: index + 1,\n              style: {\n                backgroundColor: \"#cbc0d3\"\n              },\n              children: /*#__PURE__*/_jsxDEV(\"span\", {\n                style: {\n                  display: \"flex\",\n                  justifyContent: \"space-between\"\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  children: index + 1\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 124,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: /*#__PURE__*/_jsxDEV(\"p\", {\n                    onClick: e => {\n                      handlePaymentCon(e);\n                    },\n                    children: [\"Invoice: \", item.order_number]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 125,\n                    columnNumber: 47\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 125,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: [\"Date: \", item.date]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 126,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: [\"Payment Method: \", item.payment_method]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 127,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: [\"Status: \", item.status]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 128,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: [\"Press for Detail \", /*#__PURE__*/_jsxDEV(\"i\", {\n                    className: \"fas fa-caret-square-down\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 129,\n                    columnNumber: 64\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 129,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 123,\n                columnNumber: 37\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 122,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 121,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(Accordion.Collapse, {\n            eventKey: index + 1,\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(Table, {\n                striped: true,\n                bordered: true,\n                hover: true,\n                children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n                  children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                    children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                      children: \"No\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 138,\n                      columnNumber: 49\n                    }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                      children: \"Name\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 139,\n                      columnNumber: 49\n                    }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                      children: \"Image\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 140,\n                      columnNumber: 49\n                    }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                      children: \"Quantity\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 141,\n                      columnNumber: 49\n                    }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                      children: \"Price\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 142,\n                      columnNumber: 49\n                    }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                      children: \"Total\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 143,\n                      columnNumber: 49\n                    }, this), item.status === \"On Delivery\" || item.status === \"Arrived\" ? /*#__PURE__*/_jsxDEV(\"th\", {\n                      children: \"Send From\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 148,\n                      columnNumber: 53\n                    }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {}, void 0, false)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 137,\n                    columnNumber: 45\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 136,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n                  children: item.products.map((item2, index2) => {\n                    return /*#__PURE__*/_jsxDEV(\"tr\", {\n                      children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                        children: index2 + 1\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 158,\n                        columnNumber: 57\n                      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                        children: item2.name\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 159,\n                        columnNumber: 57\n                      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                        children: /*#__PURE__*/_jsxDEV(Image, {\n                          src: item2.image,\n                          style: {\n                            height: 100,\n                            width: 100\n                          },\n                          rounded: true\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 161,\n                          columnNumber: 61\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 160,\n                        columnNumber: 57\n                      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                        children: item2.quantity\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 163,\n                        columnNumber: 57\n                      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                        children: [\"IDR \", item2.price.toLocaleString()]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 164,\n                        columnNumber: 57\n                      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                        children: [\"IDR \", item2.total.toLocaleString()]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 165,\n                        columnNumber: 57\n                      }, this), item.status === \"On Delivery\" || item.status === \"Arrived\" ? /*#__PURE__*/_jsxDEV(\"td\", {\n                        children: item2.delivery_loc.join(\", \")\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 169,\n                        columnNumber: 65\n                      }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {}, void 0, false)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 157,\n                      columnNumber: 53\n                    }, this);\n                  })\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 154,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 135,\n                columnNumber: 37\n              }, this), renderFooter(item.status, item.order_number, item.payment_confirmation, item.message)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 134,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 133,\n            columnNumber: 29\n          }, this)]\n        }, index, true, {\n          fileName: _jsxFileName,\n          lineNumber: 120,\n          columnNumber: 25\n        }, this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 13\n    }, this);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      marginTop: \"150px\",\n      padding: \"0 20px\"\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"Order History\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Table, {\n      striped: true,\n      bordered: true,\n      hover: true,\n      style: {\n        textAlign: \"center\"\n      },\n      children: renderTbody()\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 189,\n    columnNumber: 9\n  }, this);\n};\n\n_s(HistoryPage, \"ywb5nIV5XNpya/Q3gwSF36uzEmI=\", false, function () {\n  return [useSelector, useDispatch];\n});\n\n_c = HistoryPage;\nexport default HistoryPage;\n\nvar _c;\n\n$RefreshReg$(_c, \"HistoryPage\");","map":{"version":3,"sources":["C:/Users/knigh/Documents/PURWADHIKA JCWM/final_project/PWD-Warehouse-3/Final_Project_Group_3/Front_End/pwd_warehouse_03/src/pages/history.js"],"names":["React","Axios","useSelector","useDispatch","Accordion","Card","Table","Image","Button","CancelOrder","ConfirmArrived","paymentConf","Link","HistoryPage","data","setData","useState","refresh","setRefresh","id","state","user","id_user","dispatch","useEffect","fetchData","res","get","parseInt","err","console","log","handlePaymentCon","e","cancelOrder","CancelMsg","message","post","then","useRefresh","catch","confirmArrived","renderFooter","status","order_number","msg","display","justifyContent","width","marginLeft","marginBottom","marginRight","color","fontSize","renderTbody","map","item","index","Header","backgroundColor","date","payment_method","products","item2","index2","name","image","height","quantity","price","toLocaleString","total","delivery_loc","join","payment_confirmation","marginTop","padding","textAlign"],"mappings":"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","sourcesContent":["import React from 'react'\r\nimport Axios from 'axios'\r\nimport { useSelector, useDispatch } from 'react-redux'\r\nimport {\r\n    Accordion,\r\n    Card,\r\n    Table,\r\n    Image,\r\n    Button\r\n} from 'react-bootstrap'\r\nimport { CancelOrder, ConfirmArrived, paymentConf } from '../actions'\r\nimport { Link } from 'react-router-dom'\r\n\r\nconst HistoryPage = () => {\r\n    const [data, setData] = React.useState([])\r\n    const [refresh, setRefresh] = React.useState(0)\r\n    const { id } = useSelector((state) => {\r\n        return {\r\n            id: state.user.id_user,\r\n        }\r\n    })\r\n    const dispatch = useDispatch()\r\n\r\n\r\n    React.useEffect(() => {\r\n        async function fetchData() {\r\n            try {\r\n                const res = await Axios.get(`http://localhost:2000/cart/history/${parseInt(id)}`)\r\n                setData(res.data)\r\n            }\r\n            catch (err) {\r\n                console.log(err)\r\n            }\r\n\r\n        }\r\n        fetchData()\r\n    }, [id, refresh])\r\n\r\n    function handlePaymentCon(e) {\r\n        console.log(e)\r\n        dispatch(paymentConf(e))\r\n    }\r\n\r\n    const cancelOrder = (e) => {\r\n        console.log(e)\r\n        dispatch(CancelOrder(e))\r\n        let CancelMsg = { message: \"Canceled by USER\" }\r\n\r\n\r\n        Axios.post(`http://localhost:2000/admin/cancelOrder/${e}`, CancelMsg)\r\n            .then((res) => {\r\n                console.log(res.data)\r\n                let useRefresh = refresh\r\n                setRefresh(refresh + 1)\r\n                console.log(\"refresh request executed =\", useRefresh, \"times\")\r\n            })\r\n            .catch(err => {\r\n                console.log(err)\r\n            })\r\n    }\r\n\r\n    const confirmArrived = (e) => {\r\n        setRefresh(refresh + 5)\r\n        dispatch(ConfirmArrived(e))\r\n        let useRefresh = refresh\r\n        console.log(\"refresh request executed =\", useRefresh, \"times\")\r\n        console.log(e)\r\n    }\r\n\r\n    const renderFooter = (status, order_number, paymentConf, msg) => {\r\n        if (status === \"Not Paid\") {\r\n            return(\r\n                <div style={{display: 'flex', justifyContent: 'space-between', width: 235, marginLeft: 970, marginBottom: 15}}>\r\n                    <Button variant='danger' onClick={() => cancelOrder(order_number)}>Cancel</Button>\r\n                    <Button as={Link} to='/upload_payment' style={{ marginRight: '5px' }} onClick={() => handlePaymentCon(order_number)}> Confirm Payment </Button>\r\n                </div>\r\n            )\r\n        }\r\n        if (status === \"Paid\") {\r\n            return(\r\n                <div>\r\n                    <p>\r\n                        <i style={{ color: \"#457b9d\" }}>Waiting for approval payment confirmation</i>\r\n                    </p>\r\n                </div>\r\n            )\r\n        }\r\n        if (status === \"On Delivery\") {\r\n            return(\r\n                <div style={{display: 'flex', justifyContent: 'flex-end', marginRight: 25, marginBottom: 15}}>\r\n                    <Button variant='success' style={{width: '100px', fontSize: 18}} onClick={() => confirmArrived(order_number)}>Done</Button>\r\n                </div>\r\n            )\r\n        }\r\n        if (status === \"Canceled\" && paymentConf === 1) {\r\n            return(\r\n                <div>\r\n                    <p>\r\n                        <i style={{ color: \"#457b9d\" }}>Your payment has been refunded</i>\r\n                    </p>\r\n                </div> \r\n            )\r\n        }\r\n        if (status === \"Canceled\") {\r\n            return(\r\n                <div>\r\n                    <p>\r\n                        <i style={{ color: \"#457b9d\" }}>{msg}</i>\r\n                    </p>\r\n                </div> \r\n            )\r\n        }\r\n    }\r\n\r\n    const renderTbody = () => {\r\n        return (\r\n            <Accordion>\r\n                {data.map((item, index) => {\r\n                    return (\r\n                        <Card key={index}>\r\n                            <Card.Header>\r\n                                <Accordion.Toggle as={Card.Header} variant=\"link\" eventKey={index + 1} style={{ backgroundColor: \"#cbc0d3\" }}>\r\n                                    <span style={{ display: \"flex\", justifyContent: \"space-between\" }}>\r\n                                        <span>{index + 1}</span>\r\n                                        <span><p onClick={(e) => { handlePaymentCon(e) }}>Invoice: {item.order_number}</p></span>\r\n                                        <span>Date: {item.date}</span>\r\n                                        <span>Payment Method: {item.payment_method}</span>\r\n                                        <span>Status: {item.status}</span>\r\n                                        <span>Press for Detail <i className=\"fas fa-caret-square-down\"></i></span>\r\n                                    </span>\r\n                                </Accordion.Toggle>\r\n                            </Card.Header>\r\n                            <Accordion.Collapse eventKey={index + 1}>\r\n                                <div>\r\n                                    <Table striped bordered hover>\r\n                                        <thead>\r\n                                            <tr>\r\n                                                <th>No</th>\r\n                                                <th>Name</th>\r\n                                                <th>Image</th>\r\n                                                <th>Quantity</th>\r\n                                                <th>Price</th>\r\n                                                <th>Total</th>\r\n                                                {\r\n                                                    item.status === \"On Delivery\" || item.status === \"Arrived\"\r\n\r\n                                                    ?\r\n                                                    <th>Send From</th>\r\n                                                    :\r\n                                                    <></>\r\n                                                }\r\n                                            </tr>\r\n                                        </thead>\r\n                                        <tbody>\r\n                                            {item.products.map((item2, index2) => {\r\n                                                return (\r\n                                                    <tr>\r\n                                                        <td>{index2 + 1}</td>\r\n                                                        <td>{item2.name}</td>\r\n                                                        <td>\r\n                                                            <Image src={item2.image} style={{ height: 100, width: 100 }} rounded />\r\n                                                        </td>\r\n                                                        <td>{item2.quantity}</td>\r\n                                                        <td>IDR {item2.price.toLocaleString()}</td>\r\n                                                        <td>IDR {item2.total.toLocaleString()}</td>\r\n                                                        {\r\n                                                            item.status === \"On Delivery\" || item.status === \"Arrived\"\r\n                                                                ?\r\n                                                                <td>{item2.delivery_loc.join(\", \")}</td>\r\n                                                                :\r\n                                                                <></>\r\n                                                        }\r\n                                                    </tr>\r\n                                                )\r\n                                            })}\r\n                                        </tbody>\r\n                                    </Table>\r\n                                    {renderFooter(item.status, item.order_number, item.payment_confirmation, item.message)}\r\n                                </div>\r\n                            </Accordion.Collapse>\r\n                        </Card>\r\n                    )\r\n                })}\r\n            </Accordion>\r\n        )\r\n    }\r\n\r\n    return (\r\n        <div style={{ marginTop: \"150px\", padding: \"0 20px\" }}>\r\n            <h1>Order History</h1>\r\n            <Table striped bordered hover style={{ textAlign: \"center\" }}>\r\n                {renderTbody()}\r\n            </Table>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default HistoryPage"]},"metadata":{},"sourceType":"module"}